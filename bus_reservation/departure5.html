<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>백석대학교 통학버스 예매시스템</title>
    <link rel="stylesheet" href="main.css" />
    <script src="language.js"></script>
    <style>
        .choicedepa {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: flex-start;
        }
        .depa {
            background-color: #000080; /* 버튼 배경색 설정 */
            color: white; /* 텍스트 색상 */
            border: none; /* 버튼 테두리 제거 */
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            text-align: center;
            font-size: 16px;
        }
        .depa:hover {
            background-color: #5a5aff; /* 호버 시 밝은 색으로 변경 */
        }
        .selected-depa, .price {
            margin-top: 10px;
            font-size: 16px;
            color: #333;
        }
        .hidden {
            display: none;
        }
        .sub-options {
            margin-top: 20px;
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .sub-options button {
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 8px 15px;
            background-color: #005cbf;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .sub-options button:hover {
            background-color: #4080ff;
        }
    </style>
</head>
<body>
    <header>
        <div>
            <h1><a href="Main.html">Icon 통학버스 예매시스템</a></h1>
        </div>
        <nav>
            <ul>
                <li><a href="departure.html" id="nav-booking">통학버스 예매</a></li>
                <li><a href="QueryCancel.html" id="nav-query">조회/변경/취소</a></li>
                <li><a href="Timetable.html" id="nav-timetable">운행정보</a></li>
                <li><a href="Mypage.html" id="nav-mypage">마이페이지</a></li>
                <select id="language-selector" onchange="changeLanguage()">
                    <option value="ko">한국어</option>
                    <option value="en">English</option>
                    <option value="zh">中文</option>
                    <option value="ja">日本語</option>
                </select>
            </ul>
        </nav>
    </header>

    <h2>출발지를 선택해주세요.</h2>
    <br><br>

    <div align="left" class="choicedepa">
        <button class="depa" data-price="5,200원" data-has-options="true" data-options='{"locations":["영등포 로터리상가 5번출구 신한은행"], "times":["06:50"]}'>영등포</button>

        <button class="depa" data-price="5,200원" data-has-options="true" data-options='{"locations":["교대역 8번,14번출구"],"times":["07:50","08:30"]}'>교대</button>

        <button class="depa" data-price="5,200원" data-has-options="true" data-options='{"locations":["잠실역 4번출구"], "times":["07:00"]}'>잠실</button>

        <button class="depa" data-price="5,200원" data-has-options="true" data-options='{"locations":["야탑역 4번출구"], "times":["07:30","08:30"]}'>성남(분당)</button>

        <button class="depa" data-price="6,000원" data-has-options="true" data-options='{"locations":["문학경기장역 1번출구"], "times":["06:20"]}'>인천(문학)</button>

	<button class="depa" data-price="6,000원"  data-has-options="true" data-options='{"locations":["송내역 1번출구"], "times":["06:40"]}'>부천(송내)</button>

	<button class="depa" data-price="5,500원"  data-has-options="true" data-options='{"locations":["중앙역 1번출구", "상록수역 1번출구"], "times":["07:00","07:10"]}'>안산</button>

	<button class="depa" data-price="4,900원"  data-has-options="true" data-options='{"locations":["안양역 공영주차장 앞", "범계역 4번출구"], "times":["06:50","07:00"]}'>안양</button>

	<button class="depa" data-price="4,900원"  data-has-options="true" data-options='{"locations":["법원사거리","영통입구","수원신갈TG"], "times":["07:30","07:40","07:45","08:30","08:40","08:45"]}'>수원(영통)</button>

	<button class="depa" data-price="4,900원"  data-has-options="true" data-options='{"locations":["동탄이마트"], "times":["08:00","09:00"]}'>화성(동탄)</button>

	<button class="depa" data-price="4,900원"  data-has-options="true" data-options='{"locations":["터미널사거리","명지대사거리","강남대삼거리","신갈시외버스정류소"], "times":["07:10","07:15","07:30","07:35"]}'>용인</button>

	<button class="depa" data-price="4,600원"  data-has-options="true" data-options='{"locations":["수원역 파출소"], "times":["07:00"]}'>수원역</button>

	<button class="depa" data-price="4,600원"  data-has-options="true" data-options='{"locations":["병점 홈플러스 버스정류장"], "times":["07:10"]}'>화성(병점)</button>

	<button class="depa" data-price="4,600원"  data-has-options="true" data-options='{"locations":["오산역 온누리약국", "평택대 정문입구"], "times":["07:30","08:10"]}'>오산/평택</button>

	<button class="depa" data-price="5,200원"  data-has-options="true" data-options='{"locations":["경부고속도로 죽전정류장(부산)"], "times":["07:30~07:50","08:50~09:00"]}'>죽전</button>

	<button class="depa" data-price="2,000원"  data-has-options="true" data-options='{"locations":["아산시외버스터미널","아산LG전자","배방역사거리","한들물빛중학교"], "times":["07:40","07:45","07:55","08:00"]}'>아산</button>

	
    </div>

    <div class="selected-depa">
        선택된 지역: <span id="selected-depa">없음</span>
    </div>
    <div class="price">
        금액: <span id="selected-price">-</span>
    </div>
    
    <!-- 하위 옵션 -->
    <div id="sub-options" class="sub-options hidden">
        <p>세부 탑승장소를 선택하세요:</p>
        <div id="location-buttons"></div>
	<p>탑승 시간을 선택하세요:</p>
        <div id="time-buttons"></div>
    </div>
    
    <!-- "다음" 버튼 -->
    <button id="next-button" class="next-button" disabled>다음</button>

    <script>
const depaButtons = document.querySelectorAll(".depa");
const selectedDepa = document.getElementById("selected-depa");
const selectedPrice = document.getElementById("selected-price");
const nextButton = document.getElementById("next-button");
const subOptionsDiv = document.getElementById("sub-options");
const locationButtonsDiv = document.getElementById("location-buttons");
const timeButtonsDiv = document.getElementById("time-buttons");

let selectedLocation = null;
let selectedTime = null;

// 초기 "다음" 버튼 비활성화
nextButton.disabled = true;

// 출발지 버튼 이벤트 추가
depaButtons.forEach(button => {
    button.addEventListener("click", () => {
        selectedDepa.textContent = button.textContent;
        selectedPrice.textContent = button.getAttribute("data-price");

        const hasOptions = button.getAttribute("data-has-options");
        if (hasOptions === "true") {
            const options = JSON.parse(button.getAttribute("data-options"));
            renderOptions(options.locations, options.times);
        } else {
            subOptionsDiv.classList.add("hidden");
            nextButton.disabled = false;
        }
    });
});

function renderOptions(locations, times) {
    locationButtonsDiv.innerHTML = ""; // 기존 위치 옵션 제거
    timeButtonsDiv.innerHTML = ""; // 기존 시간 옵션 제거

    // 위치 옵션 생성
    locations.forEach(location => {
        const locButton = document.createElement("button");
        locButton.textContent = location;
        locButton.addEventListener("click", () => {
            selectedLocation = location;
            updateSelection();
        });
        locationButtonsDiv.appendChild(locButton);
    });

    // 시간 옵션 생성
    times.forEach(time => {
        const timeButton = document.createElement("button");
        timeButton.textContent = time;
        timeButton.addEventListener("click", () => {
            selectedTime = time;
            updateSelection();
        });
        timeButtonsDiv.appendChild(timeButton);
    });

    subOptionsDiv.classList.remove("hidden");
}

function updateSelection() {
    if (selectedLocation && selectedTime) {
        selectedDepa.textContent += ` (${selectedLocation}, ${selectedTime})`;
        subOptionsDiv.classList.add("hidden");
        nextButton.disabled = false; // 옵션 선택 완료 시 "다음" 버튼 활성화
    }
}

// "다음" 버튼 클릭 이벤트
nextButton.addEventListener("click", () => {
    const selectedData = {
        depa: selectedDepa.textContent,
        price: selectedPrice.textContent,
        location: selectedLocation,
        time: selectedTime
    };
    localStorage.setItem("selectedData", JSON.stringify(selectedData));
    window.location.href = "Ticketing.html";
});
  </script>
</body>
</html>
